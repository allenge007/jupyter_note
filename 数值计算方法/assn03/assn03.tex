\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    \usepackage{xeCJK}
    \usepackage{mathtools}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Keep aspect ratio if custom image width or height is specified
    \setkeys{Gin}{keepaspectratio}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro

    \usepackage{iftex}
    \ifPDFTeX
        \usepackage[T1]{fontenc}
        \IfFileExists{alphabeta.sty}{
              \usepackage{alphabeta}
          }{
              \usepackage[mathletters]{ucs}
              \usepackage[utf8x]{inputenc}
          }
    \else
        \usepackage{fontspec}
        \usepackage{unicode-math}
    \fi

    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{array}     % table support for pandoc >= 2.11.3
    \usepackage{calc}      % table minipage width calculation for pandoc >= 2.11.1
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{soul}      % strikethrough (\st) support for pandoc >= 3.0.0
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}

    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}


    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{assn03}
    
    
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.61,0.40,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.80,0.25,0.22}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.46,0.46,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.41,0.47,0.13}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.36,0.12}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.52,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{0.89,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb.
    \makeatletter
        \newbox\Wrappedcontinuationbox
        \newbox\Wrappedvisiblespacebox
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}}
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}}
        \newcommand*\Wrappedcontinuationindent {3ex }
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox}
        % Take advantage of the already applied Pygments mark-up to insert
        % potential linebreaks for TeX processing.
        %        {, <, #, %, $, ' and ": go to next line.
        %        _, }, ^, &, >, - and ~: stay at end of broken line.
        % Use of \textquotesingle for straight quote.
        \newcommand*\Wrappedbreaksatspecials {%
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}%
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}%
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}%
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}%
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}%
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}%
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}%
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}%
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}%
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}%
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}%
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}%
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}%
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}%
        }
        % Some characters . , ; ? ! / are not pygmentized.
        % This macro makes them "active" and they will insert potential linebreaks
        \newcommand*\Wrappedbreaksatpunct {%
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}%
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}%
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}%
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}%
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}%
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}%
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}%
            \catcode`\.\active
            \catcode`\,\active
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active
            \lccode`\~`\~
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%

        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}

    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \section{14}\label{section}

求次数小于等于 3 的多项式 \(P(x)\) 使其满足条件

\[
P(0) = 0, \quad P'(0) = 1, \quad P(1) = 1, \quad P'(1) = 2
\]

\subsection{Answer}\label{answer}

插值多项式为 \(H_3(x)\)，满足条件

\[
\begin{rcases}
H_3(0) = 0, \quad H_3(1)=1 \\
H_3'(0) = 1, \quad H_3'(1)=2
\end{rcases}
\]

令

\[
H_3(x) = \alpha_0(x)f(0) + \alpha_1(x)f(1) + \beta_0(x)f'(0) + \beta_1(x)f'(1)
\]

它们分别满足条件

\[
\begin{aligned}
\alpha_0(0) = 1,\quad \alpha_0(1) = 0, \quad \alpha_0'(0) = \alpha_0'(1) = 0 \\
\alpha_1(0) = 0, \quad \alpha_1(1) = 1, \quad \alpha_1'(0) = \alpha_1'(1) = 0\\
\beta_0(0) = \beta_0(1) = 0, \quad \beta_0'(0) = 1, \quad \beta_0'(1) = 0 \\
\beta_1(0) = \beta_1(1) = 0, \quad \beta_1'(0) = 0, \quad \beta_1'(1) = 1
\end{aligned}
\]

因此，可令

\[
a_0(x) = (ax+b)\left( \frac{x - 1}{0 - 1} \right) ^2 = (ax+b)(x - 1)^2
\]

解得

\[
\alpha_0(x) = \left( 1 + 2\frac{x - 0}{1 - 0} \right) (x - 1)^2 = 1 - 3x^2 + 2x^3
\]

同理求得

\[
\begin{aligned}
    \alpha_1(x) &= (1 + 2\frac{x - 1}{0 - 1}) x^2 = 3x^2 - 2x^3 \\
    \beta_0(x) &= (x - 0)(x - 1)^2 = x - 2x^2 + x^3 \\
    \beta_1(x) &= (x - 1)x^2 = -x^2+x^3
\end{aligned}
\]

故

\[
\begin{aligned}
H_3(x) &= \Bigl[x-2x^2+x^3\Bigr] +
\Bigl[3x^2-2x^3\Bigr] + 2\Bigl[-x^2+x^3\Bigr]\\[1mm]
&= x - x^2 + x^3.
\end{aligned}
\]

综上所述，满足要求的三次多项式为

\[
\boxed{P(x)= x - x^2 + x^3.}
\]

    \section{16}\label{section}

求一个次数不高于 4 次的多项式 \(P(x)\)，使它满足

\[
P(0) = P'(0) = 0, \quad P(1) = P'(1) = 1, \quad P(2) = 1
\]

\subsection{Answer}\label{answer}

对节点 0 与 1，有条件

\[
P(0)=0,\quad P'(0)=0,\quad P(1)=1,\quad P'(1)=1.
\]

埃尔米特插值(两点三次)

\[
H(x)= f(0)H_{00}(x)+ f'(0)H_{10}(x)+ f(1)H_{01}(x)+ f'(1)H_{11}(x),
\]

其标准基函数（与 14 题相同）为

\[
\begin{aligned}
H_{00}(x)&= 1- 3x^2 + 2x^3,\\[1mm]
H_{10}(x)&= x- 2x^2 + x^3,\\[1mm]
H_{01}(x)&= 3x^2-2x^3,\\[1mm]
H_{11}(x)&= -x^2+ x^3.
\end{aligned}
\]

代入基函数表达式，

\[
H(x)= \bigl(3x^2-2x^3\bigr)+\bigl(-x^2+x^3\bigr)= 2x^2-x^3.
\]

设

\[
R(x) = kx^2 (x-1)^2.
\]

显然：

\begin{itemize}
\tightlist
\item
  \(R(0)=0^2( -1)^2=0,\quad R(1)=1^2\cdot 0^2=0,\)
\item
  \(R'(0)=0,\; R'(1)=0.\)
\end{itemize}

最终插值多项式可写为 \[
P(x)= H(x) + R(x)= \bigl(2x^2-x^3\bigr)+ kx^2(x-1)^2.
\]

现在利用 \(P(2)=1\) 来确定 \(k\)：

\begin{itemize}
\tightlist
\item
  \(H(2)= 2\cdot 4-8=0\).
\item
  \(R(2)= k\cdot 2^2 (2-1)^2=4k\).
\end{itemize}

于是有 \[
P(2)= 0 + k\cdot 4 = 1\quad\Longrightarrow\quad k = \frac{1}{4}.
\]

代入 \(k=\frac{1}{4}\)，得

\[
\boxed{
P(x)= 2x^2 - x^3 + \frac{1}{4}\,x^2(x-1)^2.
}
\]

    \section{17}\label{section}

设 \(f(x) = \frac{1}{1 + x^2}\)，在 \(-5\le x \le 5\) 上取
\(n = 10\)，按等距节点求分段线性插值函数 \(I_h(x)\)，计算各节点中点处的
\(I_h(x)\) 与 \(f(x)\) 的值，并估计误差。

\subsection{Answer}\label{answer}

利用 python 进行数值求解，可以得到：

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{c+c1}{\PYZsh{} 定义 f(x)}
\PY{k}{def} \PY{n+nf}{f}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
    \PY{k}{return} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{+}\PY{n}{x}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 区间 [\PYZhy{}5,5] 取 n=10 等距子区间（共 11 个节点）}
\PY{n}{a}\PY{p}{,} \PY{n}{b} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}
\PY{n}{n} \PY{o}{=} \PY{l+m+mi}{10}
\PY{n}{x\PYZus{}nodes} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{a}\PY{p}{,} \PY{n}{b}\PY{p}{,} \PY{n}{n}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}   \PY{c+c1}{\PYZsh{} 节点}
\PY{n}{f\PYZus{}nodes} \PY{o}{=} \PY{n}{f}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 每个子区间的中点}
\PY{n}{x\PYZus{}mid} \PY{o}{=} \PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}
\PY{c+c1}{\PYZsh{} 分段线性插值 I\PYZus{}h 在每个子区间上是直线，}
\PY{c+c1}{\PYZsh{} 因此在中点处的插值值等于两个端点函数值的平均：}
\PY{n}{I\PYZus{}mid} \PY{o}{=} \PY{p}{(}\PY{n}{f\PYZus{}nodes}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{n}{f\PYZus{}nodes}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}
\PY{c+c1}{\PYZsh{} 真值：f 在中点处的值}
\PY{n}{f\PYZus{}mid} \PY{o}{=} \PY{n}{f}\PY{p}{(}\PY{n}{x\PYZus{}mid}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 计算各中点处绝对误差}
\PY{n}{error} \PY{o}{=} \PY{n}{f\PYZus{}mid} \PY{o}{\PYZhy{}} \PY{n}{I\PYZus{}mid}
\PY{c+c1}{\PYZsh{} 计算在更细分的节点上的误差}
\PY{n}{x2\PYZus{}nodes} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{a}\PY{p}{,} \PY{n}{b}\PY{p}{,} \PY{l+m+mi}{10001}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 细分的节点}
\PY{n}{f2\PYZus{}nodes} \PY{o}{=} \PY{n}{f}\PY{p}{(}\PY{n}{x2\PYZus{}nodes}\PY{p}{)}
\PY{n}{error2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{f2\PYZus{}nodes} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{interp}\PY{p}{(}\PY{n}{x2\PYZus{}nodes}\PY{p}{,} \PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{f\PYZus{}nodes}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 显示结果}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{子区间编号   中点 x\PYZus{}mid    I\PYZus{}h(mid)      f(mid)        绝对误差}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{i}\PY{l+s+si}{:}\PY{l+s+s2}{4d}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{      }\PY{l+s+si}{\PYZob{}}\PY{n}{x\PYZus{}mid}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s2}{8.3f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{    }\PY{l+s+si}{\PYZob{}}\PY{n}{I\PYZus{}mid}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s2}{12.6f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{  }\PY{l+s+si}{\PYZob{}}\PY{n}{f\PYZus{}mid}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s2}{12.6f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{  }\PY{l+s+si}{\PYZob{}}\PY{n}{error}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s2}{12.6f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{max error: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{error2}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 绘图比较 f(x) 与分段线性插值 I\PYZus{}h(x)}
\PY{n}{x\PYZus{}plot} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{a}\PY{p}{,} \PY{n}{b}\PY{p}{,} \PY{l+m+mi}{401}\PY{p}{)}
\PY{n}{I\PYZus{}h} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{interp}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{,} \PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{f\PYZus{}nodes}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{,} \PY{n}{f}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{f(x)=1/(1+x\PYZca{}2)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{,} \PY{n}{I\PYZus{}h}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}I\PYZus{}h(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{f\PYZus{}nodes}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ko}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{nodes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{x}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{y}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}I\PYZus{}h(x)\PYZdl{} \PYZam{} f(x)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
子区间编号   中点 x\_mid    I\_h(mid)      f(mid)        绝对误差
   0        -4.500        0.048643      0.047059     -0.001584
   1        -3.500        0.079412      0.075472     -0.003940
   2        -2.500        0.150000      0.137931     -0.012069
   3        -1.500        0.350000      0.307692     -0.042308
   4        -0.500        0.750000      0.800000      0.050000
   5         0.500        0.750000      0.800000      0.050000
   6         1.500        0.350000      0.307692     -0.042308
   7         2.500        0.150000      0.137931     -0.012069
   8         3.500        0.079412      0.075472     -0.003940
   9         4.500        0.048643      0.047059     -0.001584

max error:  0.0674421560550783
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_3_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    理论误差限分析：

对于分段线性插值，在区间 {[}a,b{]} 上（等距节点，步长 h）如果
\(f ∈ C²\)，那么在任一子区间内的插值误差满足

\[
|f(x)-I_h(x)|\le \frac{h^2}{8}\max_{\xi\in[x_i,x_{i+1}]}|f''(\xi)|.
\]

已知\\
\[
f(x)=\frac{1}{1+x^2},\quad x\in[-5,5],
\]

且取 n=10 个子区间，所以步长 \[
h=\frac{5-(-5)}{10}=1.
\]

接下来我们需要估计 \(f''(x)\) 的最大值。

先计算一阶导数： \[
f(x)= (1+x^2)^{-1}\quad\Longrightarrow\quad f'(x) = -\frac{2x}{(1+x^2)^2}.
\] 再求二阶导数： \[
f''(x)= \frac{-2(1+x^2)^2 - (-2x) \cdot 2(1+x^2)\cdot 2x}{(1+x^2)^4}.
\] 化简： \[
f''(x)= \frac{-2(1+x^2)^2 + 8x^2(1+x^2)}{(1+x^2)^4}
=\frac{-2(1+x^2)+ 8x^2}{(1+x^2)^3}
=\frac{-2 +6x^2}{(1+x^2)^3}.
\]

函数 \(f(x)=\frac{1}{1+x^2}\)
为偶函数，其二阶导数也是偶函数，因此只需要考虑 x ≥ 0。

观察表达式： \[
f''(x)=\frac{-2+6x^2}{(1+x^2)^3}.
\]

可以发现，在整个区间内 \(|f''(x)|\) 最大值就在 \(x=0\) 处，为 2。

带入标准误差公式，有

\[
|f(x)-I_h(x)|\le \frac{h^2}{8}\max_{x\in[-5,5]}|f''(x)| \le \frac{1^2}{8}\cdot 2 = \frac{2}{8}=0.25.
\]

综上，对于在 \([-5,5]\) 上取 10
个等距节点进行分段线性插值，理论上误差满足

\[
\boxed{
|f(x)-I_h(x)|\le 0.25}
\]

符合数值计算结果

    \section{19}\label{section}

求 \(f(x) = x^4\) 在 \([a, b]\) 上的分段埃尔米特插值，并估计误差。

\subsection{Answer}\label{answer}

将区间 \([a,b]\) 等分为 \(n\) 个子区间，每个子区间的长度为

\[
h = \frac{b-a}{n}.
\]

令分点为 \[
x_i = a + i\, h,\quad i = 0,1,\dots,n.
\]

在任一子区间 \([x_i, x_{i+1}]\) 上，构造三次多项式 \(H(x)\)，满足

\[
\begin{aligned}
H(x_i) &= f(x_i)= x_i^4,\qquad &H'(x_i) &= f'(x_i)= 4x_i^3,\\[1mm]
H(x_{i+1}) &= f(x_{i+1}) = x_{i+1}^4,\qquad &H'(x_{i+1}) &= f'(x_{i+1})= 4 x_{i+1}^3.
\end{aligned}
\]

利用标准的两点埃尔米特插值公式，令 \[
t = \frac{x - x_i}{h},\quad 0\le t\le 1,
\] 则插值多项式写为 \[
H(x)= f(x_i)\, H_{00}(t) + f(x_{i+1})\, H_{01}(t) + h\, f'(x_i)\, H_{10}(t) + h\, f'(x_{i+1})\, H_{11}(t),
\] 其中标准基函数（与 14、16 题相同）为 \[
\begin{aligned}
H_{00}(t) &= 2t^3 - 3t^2 + 1,\\[1mm]
H_{10}(t) &= t^3 - 2t^2 + t,\\[1mm]
H_{01}(t) &= -2t^3 + 3t^2,\\[1mm]
H_{11}(t) &= t^3 - t^2.
\end{aligned}
\]

误差分析：

\(f \in C^4\)，则在任一子区间 \([x_i, x_{i+1}]\) 内存在
\(\xi\in(x_i,x_{i+1})\) 使得插值误差满足:

\[
f(x)-H(x) = \frac{f^{(4)}(\xi)}{4!}\,(x-x_i)^2\,(x-x_{i+1})^2.
\] \(f(x)=x^4\) 的四阶导数为 \[
f^{(4)}(x)=24,
\] 因此余项公式简化为 \[
f(x)-H(x) = (x-x_i)^2\,(x-x_{i+1})^2.
\]

令 \(x=x_i+th\)（其中 \(t\in[0,1]\)），则有 \[
x-x_i = t\,h,\quad x-x_{i+1} = t\,h -h = h(t-1).
\] 因此，误差的绝对值为 \[
|f(x)-H(x)| = h^4\, t^2 (1-t)^2.
\] 在 \(t\in [0,1]\) 上，函数 \(t^2(1-t)^2\) 的最大值出现在
\(t=\frac12\)，其值为 \[
\left(\frac{1}{2}\right)^2\left(1-\frac{1}{2}\right)^2 = \frac{1}{16}.
\] 因此，在每个子区间上最大误差满足 \[
|f(x)-H(x)|\le \frac{h^4}{16}.
\] 使用 python 验证结果：

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 设置区间和分割数}
\PY{n}{a}\PY{p}{,} \PY{n}{b} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}
\PY{n}{n} \PY{o}{=} \PY{l+m+mi}{10}
\PY{n}{h} \PY{o}{=} \PY{p}{(}\PY{n}{b} \PY{o}{\PYZhy{}} \PY{n}{a}\PY{p}{)} \PY{o}{/} \PY{n}{n}
\PY{c+c1}{\PYZsh{} 定义 f(x)=x\PYZca{}4 及其导数}
\PY{k}{def} \PY{n+nf}{f}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
    \PY{k}{return} \PY{n}{x}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{4}
\PY{k}{def} \PY{n+nf}{fp}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
    \PY{k}{return} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{x}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3}
\PY{c+c1}{\PYZsh{} 定义 Hermite 基函数}
\PY{k}{def} \PY{n+nf}{H00}\PY{p}{(}\PY{n}{t}\PY{p}{)}\PY{p}{:}
    \PY{k}{return} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3} \PY{o}{\PYZhy{}} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{1}
\PY{k}{def} \PY{n+nf}{H10}\PY{p}{(}\PY{n}{t}\PY{p}{)}\PY{p}{:}
    \PY{k}{return} \PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3} \PY{o}{\PYZhy{}} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{t}
\PY{k}{def} \PY{n+nf}{H01}\PY{p}{(}\PY{n}{t}\PY{p}{)}\PY{p}{:}
    \PY{k}{return} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3} \PY{o}{+} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
\PY{k}{def} \PY{n+nf}{H11}\PY{p}{(}\PY{n}{t}\PY{p}{)}\PY{p}{:}
    \PY{k}{return} \PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3} \PY{o}{\PYZhy{}} \PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
\PY{c+c1}{\PYZsh{} 修改后的分段 Hermite 插值函数，处理边界点情况}
\PY{k}{def} \PY{n+nf}{hermite\PYZus{}piecewise}\PY{p}{(}\PY{n}{x\PYZus{}val}\PY{p}{,} \PY{n}{nodes}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} 如果 x\PYZus{}val 恰好等于第一个节点，直接返回 f(x\PYZus{}val)}
    \PY{k}{if} \PY{n}{np}\PY{o}{.}\PY{n}{isclose}\PY{p}{(}\PY{n}{x\PYZus{}val}\PY{p}{,} \PY{n}{nodes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{f}\PY{p}{(}\PY{n}{x\PYZus{}val}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 如果 x\PYZus{}val 恰好等于最后一个节点，归为最后一子区间}
    \PY{k}{if} \PY{n}{np}\PY{o}{.}\PY{n}{isclose}\PY{p}{(}\PY{n}{x\PYZus{}val}\PY{p}{,} \PY{n}{nodes}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
        \PY{n}{i} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{nodes}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{2}
    \PY{k}{else}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} np.searchsorted(nodes, x\PYZus{}val)返回第一个 \PYZgt{}= x\PYZus{}val 的索引}
        \PY{n}{i} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{searchsorted}\PY{p}{(}\PY{n}{nodes}\PY{p}{,} \PY{n}{x\PYZus{}val}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}
    \PY{n}{x\PYZus{}i} \PY{o}{=} \PY{n}{nodes}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n}{x\PYZus{}ip1} \PY{o}{=} \PY{n}{nodes}\PY{p}{[}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{t} \PY{o}{=} \PY{p}{(}\PY{n}{x\PYZus{}val} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}i}\PY{p}{)} \PY{o}{/} \PY{n}{h}
    \PY{n}{val} \PY{o}{=} \PY{p}{(}\PY{n}{f}\PY{p}{(}\PY{n}{x\PYZus{}i}\PY{p}{)}\PY{o}{*}\PY{n}{H00}\PY{p}{(}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{f}\PY{p}{(}\PY{n}{x\PYZus{}ip1}\PY{p}{)}\PY{o}{*}\PY{n}{H01}\PY{p}{(}\PY{n}{t}\PY{p}{)} \PY{o}{+}
           \PY{n}{h}\PY{o}{*}\PY{n}{fp}\PY{p}{(}\PY{n}{x\PYZus{}i}\PY{p}{)}\PY{o}{*}\PY{n}{H10}\PY{p}{(}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{h}\PY{o}{*}\PY{n}{fp}\PY{p}{(}\PY{n}{x\PYZus{}ip1}\PY{p}{)}\PY{o}{*}\PY{n}{H11}\PY{p}{(}\PY{n}{t}\PY{p}{)}\PY{p}{)}
    \PY{k}{return} \PY{n}{val}
\PY{c+c1}{\PYZsh{} 构造节点}
\PY{n}{nodes} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{a}\PY{p}{,} \PY{n}{b}\PY{p}{,} \PY{n}{n}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 构造细网格用于评估插值函数}
\PY{n}{x\PYZus{}plot} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{a}\PY{p}{,} \PY{n}{b}\PY{p}{,} \PY{l+m+mi}{400}\PY{p}{)}
\PY{n}{H\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{hermite\PYZus{}piecewise}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{nodes}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{x\PYZus{}plot}\PY{p}{]}\PY{p}{)}
\PY{n}{f\PYZus{}vals} \PY{o}{=} \PY{n}{f}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 计算误差}
\PY{n}{error} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{f\PYZus{}vals} \PY{o}{\PYZhy{}} \PY{n}{H\PYZus{}vals}\PY{p}{)}
\PY{n}{max\PYZus{}error} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{error}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 理论误差上界，每个子区间上最大误差 \PYZlt{}= h\PYZca{}4/16}
\PY{n}{error\PYZus{}bound} \PY{o}{=} \PY{n}{h}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{4} \PY{o}{/} \PY{l+m+mi}{16}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{步长 h = }\PY{l+s+si}{\PYZob{}}\PY{n}{h}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{每个子区间理论误差上界 h\PYZca{}4/16 = }\PY{l+s+si}{\PYZob{}}\PY{n}{error\PYZus{}bound}\PY{l+s+si}{:}\PY{l+s+s2}{.6e}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{整体最大误差 = }\PY{l+s+si}{\PYZob{}}\PY{n}{max\PYZus{}error}\PY{l+s+si}{:}\PY{l+s+s2}{.6e}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 绘图比较真值和插值函数}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{,} \PY{n}{f\PYZus{}vals}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}f(x)=x\PYZca{}4\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{,} \PY{n}{H\PYZus{}vals}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hermite Interpolation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{nodes}\PY{p}{,} \PY{n}{f}\PY{p}{(}\PY{n}{nodes}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ko}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{nodes}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}f(x)=x\PYZca{}4\PYZdl{} \PYZam{} Intervals Hermite Interpolation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
步长 h = 1.0
每个子区间理论误差上界 h\^{}4/16 = 6.250000e-02
整体最大误差 = 6.249921e-02
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_6_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{20}\label{section}

给定数据表如下

\begin{longtable}[]{@{}llllll@{}}
\toprule\noalign{}
\(x_j\) & 0.25 & 0.30 & 0.39 & 0.45 & 0.53 \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(y_j\) & 0.5000 & 0.5477 & 0.6245 & 0.6708 & 0.7280 \\
\end{longtable}

试求三次样条插值 \(S(x)\) 并满足条件：

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(S'(0.25) = 1.0000, \quad S'(0.53) = 0.6868.\)
\item
  \(S''(0.25) = S''(0.53) = 0.\)
\end{enumerate}

设各区间步长\\
\[
h_j = x_{j+1}-x_j,\quad j=0,1,2,3,
\] 以及差商\\
\[
d_j=\frac{y_{j+1}-y_j}{h_j},\quad j=0,1,2,3.
\]

记节点处的未知值为\\
\[
m_j = S''(x_j),\quad j=0,1,2,3,4.
\]

然后标准三次样条内节点（\(j=1,2,3\)）满足方程 \[
h_{j-1}\,m_{j-1}+2(h_{j-1}+h_j)\,m_j+h_j\,m_{j+1}= 6\Bigl(d_j-d_{j-1}\Bigr),\quad j=1,2,3.
\] 对于边界，分别有两种情况。

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{（一）两端一阶导数值已知}\label{ux4e00ux4e24ux7aefux4e00ux9636ux5bfcux6570ux503cux5df2ux77e5}

边界条件给定： \[
S'(x_0)=1.0000,\quad S'(x_4)=0.6868,
\] 对应的边界方程为： \[
\begin{aligned}
2h_0\,m_0 + h_0\,m_1 &= 6\Bigl(d_0-S'(x_0)\Bigr),\\[1mm]
h_3\,m_3 + 2h_3\,m_4 &= 6\Bigl(S'(x_4)-d_3\Bigr).
\end{aligned}
\] 因此，构造的 5×5 系统可以写成矩阵形式 \[
A_{\text{clamped}}\,\mathbf{m} = \mathbf{b}_{\text{clamped}},
\] 其中 \[
A_{\text{clamped}}=
\begin{pmatrix}
2h_0 & h_0 & 0    & 0    & 0\\[1mm]
h_0  & 2(h_0+h_1) & h_1 & 0    & 0\\[1mm]
0    & h_1  & 2(h_1+h_2) & h_2 & 0\\[1mm]
0    & 0    & h_2  & 2(h_2+h_3) & h_3\\[1mm]
0    & 0    & 0    & h_3  & 2h_3
\end{pmatrix},\quad
\mathbf{b}_{\text{clamped}}=
\begin{pmatrix}
6\Bigl(d_0- S'(x_0)\Bigr)\\[1mm]
6\Bigl(d_1-d_0\Bigr)\\[1mm]
6\Bigl(d_2-d_1\Bigr)\\[1mm]
6\Bigl(d_3-d_2\Bigr)\\[1mm]
6\Bigl(S'(x_4)-d_3\Bigr)
\end{pmatrix}.
\] \(x_0=0.25,\; x_4=0.53\).

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{（二）自然边界条件}\label{ux4e8cux81eaux7136ux8fb9ux754cux6761ux4ef6}

自然边界条件要求 \[
m_0 = m_4 = 0.
\] 则只在内节点 \(j=1,2,3\) 有方程： \[
h_{j-1}\,m_{j-1}+2(h_{j-1}+h_j)\,m_j+h_j\,m_{j+1}=6\Bigl(d_j-d_{j-1}\Bigr),\quad j=1,2,3.
\] 记向量为 \((m_1, m_2, m_3)^T\)，矩阵形式为 \[
A_{\text{natural}}=
\begin{pmatrix}
2(h_0+h_1) & h_1   & 0\\[1mm]
h_1        & 2(h_1+h_2) & h_2\\[1mm]
0          & h_2   & 2(h_2+h_3)
\end{pmatrix},\quad
\mathbf{b}_{\text{natural}}=
\begin{pmatrix}
6(d_1-d_0)\\[1mm]
6(d_2-d_1)\\[1mm]
6(d_3-d_2)
\end{pmatrix}.
\] 并令 \(m_0=m_4=0\)，得到完整的 \(m\) 向量为
\((0, m_1, m_2, m_3, 0)^T\).

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

利用 Python 代码分别求解这两种边界条件数值解：

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{106}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 给定数据}
\PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.25}\PY{p}{,} \PY{l+m+mf}{0.30}\PY{p}{,} \PY{l+m+mf}{0.39}\PY{p}{,} \PY{l+m+mf}{0.45}\PY{p}{,} \PY{l+m+mf}{0.53}\PY{p}{]}\PY{p}{)}
\PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.5000}\PY{p}{,} \PY{l+m+mf}{0.5477}\PY{p}{,} \PY{l+m+mf}{0.6245}\PY{p}{,} \PY{l+m+mf}{0.6708}\PY{p}{,} \PY{l+m+mf}{0.7280}\PY{p}{]}\PY{p}{)}
\PY{n}{n\PYZus{}nodes} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 计算各区间步长和差商 d\PYZus{}j}
\PY{n}{h} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{n}{x}\PY{p}{)}  \PY{c+c1}{\PYZsh{} [0.05, 0.09, 0.06, 0.08]}
\PY{n}{d} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{o}{/} \PY{n}{h}
\PY{c+c1}{\PYZsh{} \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{} (一) 夹紧边界条件 \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} 已知: S\PYZsq{}(x0)=1.0000, S\PYZsq{}(x4)=0.6868.}
\PY{n}{A\PYZus{}clamped} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
\PY{n}{b\PYZus{}clamped} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 边界左： 2h0*m0 + h0*m1 = 6(d0 \PYZhy{} S\PYZsq{}(x0))}
\PY{n}{A\PYZus{}clamped}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{A\PYZus{}clamped}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{b\PYZus{}clamped}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{6} \PY{o}{*} \PY{p}{(}\PY{n}{d}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mf}{1.0000}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 内节点 j=1,2,3}
\PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{:}
    \PY{n}{A\PYZus{}clamped}\PY{p}{[}\PY{n}{j}\PY{p}{,} \PY{n}{j}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{n}{j}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{A\PYZus{}clamped}\PY{p}{[}\PY{n}{j}\PY{p}{,} \PY{n}{j}\PY{p}{]}   \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{*} \PY{p}{(}\PY{n}{h}\PY{p}{[}\PY{n}{j}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{n}{h}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}
    \PY{n}{A\PYZus{}clamped}\PY{p}{[}\PY{n}{j}\PY{p}{,} \PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{n}{j}\PY{p}{]}
    \PY{n}{b\PYZus{}clamped}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{6} \PY{o}{*} \PY{p}{(}\PY{n}{d}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{p}{[}\PY{n}{j}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 边界右： h3*m3 + 2h3*m4 = 6(S\PYZsq{}(x4)\PYZhy{}d3), S\PYZsq{}(x4)=0.6868}
\PY{n}{A\PYZus{}clamped}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}
\PY{n}{A\PYZus{}clamped}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}
\PY{n}{b\PYZus{}clamped}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{6} \PY{o}{*} \PY{p}{(}\PY{l+m+mf}{0.6868} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{夹紧边界条件下的系数矩阵 A\PYZus{}clamped:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{A\PYZus{}clamped}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{右侧向量 b\PYZus{}clamped:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{b\PYZus{}clamped}\PY{p}{)}
\PY{n}{m\PYZus{}clamped} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{solve}\PY{p}{(}\PY{n}{A\PYZus{}clamped}\PY{p}{,} \PY{n}{b\PYZus{}clamped}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{夹紧条件下求得 m = [m0, m1, m2, m3, m4]:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{m\PYZus{}clamped}\PY{p}{)}
\PY{c+c1}{\PYZsh{} \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{} (二) 自然边界条件 \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} 自然条件： m0 = m4 = 0, 只需解内节点 m1, m2, m3.}
\PY{n}{A\PYZus{}natural} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{b\PYZus{}natural} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 内节点 j=1,2,3}
\PY{c+c1}{\PYZsh{} j=1:}
\PY{n}{A\PYZus{}natural}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{*} \PY{p}{(}\PY{n}{h}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\PY{n}{A\PYZus{}natural}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{b\PYZus{}natural}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{6} \PY{o}{*} \PY{p}{(}\PY{n}{d}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{d}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\PY{c+c1}{\PYZsh{} j=2:}
\PY{n}{A\PYZus{}natural}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{A\PYZus{}natural}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{*} \PY{p}{(}\PY{n}{h}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
\PY{n}{A\PYZus{}natural}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}
\PY{n}{b\PYZus{}natural}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{6} \PY{o}{*} \PY{p}{(}\PY{n}{d}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{d}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\PY{c+c1}{\PYZsh{} j=3:}
\PY{n}{A\PYZus{}natural}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}
\PY{n}{A\PYZus{}natural}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{*} \PY{p}{(}\PY{n}{h}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{+} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{b\PYZus{}natural}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{6} \PY{o}{*} \PY{p}{(}\PY{n}{d}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{d}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{自然边界条件下的系数矩阵 A\PYZus{}natural:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{A\PYZus{}natural}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{右侧向量 b\PYZus{}natural:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{b\PYZus{}natural}\PY{p}{)}
\PY{n}{m\PYZus{}natural\PYZus{}inner} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{solve}\PY{p}{(}\PY{n}{A\PYZus{}natural}\PY{p}{,} \PY{n}{b\PYZus{}natural}\PY{p}{)}
\PY{c+c1}{\PYZsh{} m0 = m4 = 0, 构造完整向量}
\PY{n}{m\PYZus{}natural} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{m\PYZus{}natural\PYZus{}inner}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{自然条件下求得 m = [m0, m1, m2, m3, m4]:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{m\PYZus{}natural}\PY{p}{)}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{} 定义三次样条评价函数 \PYZhy{}\PYZhy{}\PYZhy{}}
\PY{k}{def} \PY{n+nf}{eval\PYZus{}spline}\PY{p}{(}\PY{n}{x\PYZus{}val}\PY{p}{,} \PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} 找所在区间 [x\PYZus{}j, x\PYZus{}\PYZob{}j+1\PYZcb{}]}
    \PY{k}{if} \PY{n}{x\PYZus{}val} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}
        \PY{n}{j} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{k}{elif} \PY{n}{x\PYZus{}val} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{:}
        \PY{n}{j} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{j} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{searchsorted}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{x\PYZus{}val}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}
    \PY{n}{x\PYZus{}j} \PY{o}{=} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{p}{]}
    \PY{n}{x\PYZus{}j1} \PY{o}{=} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{h\PYZus{}seg} \PY{o}{=} \PY{n}{x\PYZus{}j1} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}j}
    \PY{n}{A} \PY{o}{=} \PY{p}{(}\PY{n}{x\PYZus{}j1} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}val}\PY{p}{)} \PY{o}{/} \PY{n}{h\PYZus{}seg}
    \PY{n}{B} \PY{o}{=} \PY{p}{(}\PY{n}{x\PYZus{}val} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}j}\PY{p}{)} \PY{o}{/} \PY{n}{h\PYZus{}seg}
    \PY{c+c1}{\PYZsh{} 三次样条公式}
    \PY{n}{Sx} \PY{o}{=} \PY{n}{A}\PY{o}{*}\PY{n}{y\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{y\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{h\PYZus{}seg}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{6} \PY{o}{*} \PY{p}{(}\PY{p}{(}\PY{n}{A}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3} \PY{o}{\PYZhy{}} \PY{n}{A}\PY{p}{)}\PY{o}{*}\PY{n}{m}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{B}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3} \PY{o}{\PYZhy{}} \PY{n}{B}\PY{p}{)}\PY{o}{*}\PY{n}{m}\PY{p}{[}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 一阶导数}
    \PY{n}{Sx1} \PY{o}{=} \PY{p}{(}\PY{n}{y\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{y\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{n}{h\PYZus{}seg} \PY{o}{+} \PY{p}{(}\PY{n}{h\PYZus{}seg}\PY{o}{/}\PY{l+m+mi}{6}\PY{p}{)}\PY{o}{*}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{B}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{*}\PY{n}{m}\PY{p}{[}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{A}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{*}\PY{n}{m}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 二阶导数}
    \PY{n}{Sx2} \PY{o}{=} \PY{n}{A}\PY{o}{*}\PY{n}{m}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{m}\PY{p}{[}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{k}{return} \PY{n}{Sx}\PY{p}{,} \PY{n}{Sx1}\PY{p}{,} \PY{n}{Sx2}
\PY{k}{def} \PY{n+nf}{evaluate\PYZus{}spline\PYZus{}on\PYZus{}grid}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{,} \PY{n}{num}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}\PY{p}{:}
    \PY{n}{x\PYZus{}plot} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{num}\PY{p}{)}
    \PY{n}{S\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros\PYZus{}like}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{)}
    \PY{n}{S1\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros\PYZus{}like}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{)}
    \PY{n}{S2\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros\PYZus{}like}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{)}
    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{xv} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{)}\PY{p}{:}
        \PY{n}{S\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{S1\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{S2\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{eval\PYZus{}spline}\PY{p}{(}\PY{n}{xv}\PY{p}{,} \PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{)}
    \PY{k}{return} \PY{n}{x\PYZus{}plot}\PY{p}{,} \PY{n}{S\PYZus{}vals}\PY{p}{,} \PY{n}{S1\PYZus{}vals}\PY{p}{,} \PY{n}{S2\PYZus{}vals}
\PY{c+c1}{\PYZsh{} 分别评价两种边界条件下的样条}
\PY{n}{x\PYZus{}plot}\PY{p}{,} \PY{n}{S\PYZus{}clamped}\PY{p}{,} \PY{n}{S1\PYZus{}clamped}\PY{p}{,} \PY{n}{S2\PYZus{}clamped} \PY{o}{=} \PY{n}{evaluate\PYZus{}spline\PYZus{}on\PYZus{}grid}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{m\PYZus{}clamped}\PY{p}{)}
\PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{S\PYZus{}natural}\PY{p}{,} \PY{n}{S1\PYZus{}natural}\PY{p}{,} \PY{n}{S2\PYZus{}natural} \PY{o}{=} \PY{n}{evaluate\PYZus{}spline\PYZus{}on\PYZus{}grid}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{m\PYZus{}natural}\PY{p}{)}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{} 绘图：以两列方式并排比较 \PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{sharex}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 第一列：夹紧条件下}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{,} \PY{n}{S\PYZus{}clamped}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}S(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ko}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{nodes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Clamped Spline: \PYZdl{}S(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{,} \PY{n}{S1\PYZus{}clamped}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Clamped Spline: \PYZdl{}S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{,} \PY{n}{S2\PYZus{}clamped}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Clamped Spline: \PYZdl{}S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{x}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{;} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 第二列：自然条件下}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{,} \PY{n}{S\PYZus{}natural}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}S(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ko}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{nodes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Natural Spline: \PYZdl{}S(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{,} \PY{n}{S1\PYZus{}natural}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Natural Spline: \PYZdl{}S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}plot}\PY{p}{,} \PY{n}{S2\PYZus{}natural}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Natural Spline: \PYZdl{}S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{x}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{;} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
夹紧边界条件下的系数矩阵 A\_clamped:
[[0.1  0.05 0.   0.   0.  ]
 [0.05 0.28 0.09 0.   0.  ]
 [0.   0.09 0.3  0.06 0.  ]
 [0.   0.   0.06 0.28 0.08]
 [0.   0.   0.   0.08 0.16]]
右侧向量 b\_clamped:
[-0.276  -0.604  -0.49   -0.34   -0.1692]
夹紧条件下求得 m = [m0, m1, m2, m3, m4]:
[-2.0286295  -1.462741   -1.03334495 -0.80583043 -0.65458479]

自然边界条件下的系数矩阵 A\_natural:
[[0.28 0.09 0.  ]
 [0.09 0.3  0.06]
 [0.   0.06 0.28]]
右侧向量 b\_natural:
[-0.604 -0.49  -0.34 ]
自然条件下求得 m = [m0, m1, m2, m3, m4]:
[ 0.         -1.8795495  -0.86362379 -1.02922347  0.        ]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{3}\label{section}

下列数据点的插值

\begin{longtable}[]{@{}llllllllll@{}}
\toprule\noalign{}
\(x\) & 0 & 1 & 4 & 9 & 16 & 25 & 36 & 49 & 64 \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(y\) & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
\end{longtable}

可以得到平方根的近似，在区间 \([0, 64]\) 上作图。

\begin{enumerate}
\def\labelenumi{(\arabic{enumi})}
\tightlist
\item
  用这 9 个点作 8 次多项式 \(L_8(x)\)
\item
  用三次样条（第一边界条件）程序求 \(S(x)\)
\end{enumerate}

从得到的结果看在 \([0, 64]\) 上，哪个插值更精确？在 \([0, 1]\)
上，哪个更精确？

\subsection{Answer}\label{answer}

使用 python 分别用两种方法进行插值：

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{108}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 给定数据}
\PY{n}{x\PYZus{}nodes} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{,} \PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{,} \PY{l+m+mi}{36}\PY{p}{,} \PY{l+m+mi}{49}\PY{p}{,} \PY{l+m+mi}{64}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
\PY{n}{y\PYZus{}nodes} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 真值函数，即平方根（注意：由于数据正好满足 y = sqrt(x)）}
\PY{n}{f} \PY{o}{=} \PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{x}\PY{p}{)}
\PY{c+c1}{\PYZsh{} \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{} (1) 全局8次多项式插值 L8(x) \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} 使用 np.polyfit 求得系数（最高次系数在前）}
\PY{n}{coeffs} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 构造多项式函数}
\PY{n}{L8} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{poly1d}\PY{p}{(}\PY{n}{coeffs}\PY{p}{)}
\PY{c+c1}{\PYZsh{} \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{} (2) 三次样条插值 S(x)（夹紧边界条件）\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} 构造步长及差商}
\PY{n}{h} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{)}  \PY{c+c1}{\PYZsh{} h\PYZus{}j, j=0,...,7 (注意：数据有9点，共8个子区间)}
\PY{n}{d} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{n}{y\PYZus{}nodes}\PY{p}{)}\PY{o}{/}\PY{n}{h}
\PY{c+c1}{\PYZsh{} 构造5个节点：由于数据点个数为9，我们构ue构成三次样条时 m = S\PYZsq{}\PYZsq{}(x) at all nodes}
\PY{c+c1}{\PYZsh{} 注意：x\PYZus{}nodes 已用作节点，这里我们有 n=9, 子区间数 = 8.}
\PY{n}{n} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 构造系数矩阵 A (n x n) 和 b (n x 1)}
\PY{n}{A} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{n}\PY{p}{)}\PY{p}{)}
\PY{n}{b\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{n}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 对内节点 j=1,...,n\PYZhy{}2（即 j=1,...,7）}
\PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{n}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
    \PY{n}{A}\PY{p}{[}\PY{n}{j}\PY{p}{,} \PY{n}{j}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{n}{j}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{A}\PY{p}{[}\PY{n}{j}\PY{p}{,} \PY{n}{j}\PY{p}{]}   \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{p}{(}\PY{n}{h}\PY{p}{[}\PY{n}{j}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{n}{h}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}
    \PY{n}{A}\PY{p}{[}\PY{n}{j}\PY{p}{,} \PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{n}{j}\PY{p}{]}
    \PY{n}{b\PYZus{}vec}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{6}\PY{o}{*}\PY{p}{(}\PY{n}{d}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{d}\PY{p}{[}\PY{n}{j}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 边界：夹紧条件 S\PYZsq{}(x0)=2.0, S\PYZsq{}(x63)=S\PYZsq{}(64)=1/16}
\PY{c+c1}{\PYZsh{} 对左端点}
\PY{n}{A}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{h}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{A}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{b\PYZus{}vec}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{6}\PY{o}{*}\PY{p}{(}\PY{n}{d}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{l+m+mf}{2.0}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 对右端点}
\PY{n}{A}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{A}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{h}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{b\PYZus{}vec}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{6}\PY{o}{*}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{16}\PY{o}{\PYZhy{}}\PY{n}{d}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 求解 m 向量}
\PY{n}{m} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{solve}\PY{p}{(}\PY{n}{A}\PY{p}{,} \PY{n}{b\PYZus{}vec}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 定义样条评价函数（前面已经给出公式）}
\PY{k}{def} \PY{n+nf}{eval\PYZus{}spline}\PY{p}{(}\PY{n}{x\PYZus{}val}\PY{p}{,} \PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{x\PYZus{}val} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}
        \PY{n}{j} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{k}{elif} \PY{n}{x\PYZus{}val} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{:}
        \PY{n}{j} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{j} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{searchsorted}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{x\PYZus{}val}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}
    \PY{n}{xj} \PY{o}{=} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{p}{]}
    \PY{n}{xj1} \PY{o}{=} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{hj} \PY{o}{=} \PY{n}{xj1} \PY{o}{\PYZhy{}} \PY{n}{xj}
    \PY{n}{A\PYZus{}coef} \PY{o}{=} \PY{p}{(}\PY{n}{xj1} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}val}\PY{p}{)}\PY{o}{/}\PY{n}{hj}
    \PY{n}{B\PYZus{}coef} \PY{o}{=} \PY{p}{(}\PY{n}{x\PYZus{}val} \PY{o}{\PYZhy{}} \PY{n}{xj}\PY{p}{)}\PY{o}{/}\PY{n}{hj}
    \PY{n}{Sx} \PY{o}{=} \PY{n}{A\PYZus{}coef}\PY{o}{*}\PY{n}{y\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{+} \PY{n}{B\PYZus{}coef}\PY{o}{*}\PY{n}{y\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{hj}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{6}\PY{o}{*}\PY{p}{(} \PY{p}{(}\PY{n}{A\PYZus{}coef}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3}\PY{o}{\PYZhy{}}\PY{n}{A\PYZus{}coef}\PY{p}{)}\PY{o}{*}\PY{n}{m}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{B\PYZus{}coef}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3}\PY{o}{\PYZhy{}}\PY{n}{B\PYZus{}coef}\PY{p}{)}\PY{o}{*}\PY{n}{m}\PY{p}{[}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]} \PY{p}{)}
    \PY{k}{return} \PY{n}{Sx}
\PY{k}{def} \PY{n+nf}{evaluate\PYZus{}spline}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{,} \PY{n}{x\PYZus{}plot}\PY{p}{)}\PY{p}{:}
    \PY{n}{S\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{eval\PYZus{}spline}\PY{p}{(}\PY{n}{xv}\PY{p}{,} \PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{)} \PY{k}{for} \PY{n}{xv} \PY{o+ow}{in} \PY{n}{x\PYZus{}plot}\PY{p}{]}\PY{p}{)}
    \PY{k}{return} \PY{n}{S\PYZus{}vals}
\PY{c+c1}{\PYZsh{} 构造评价网格}
\PY{n}{x\PYZus{}full} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{400}\PY{p}{)}
\PY{n}{x\PYZus{}small} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{200}\PY{p}{)}  \PY{c+c1}{\PYZsh{} [0,1]上的子区间}
\PY{n}{L8\PYZus{}full} \PY{o}{=} \PY{n}{L8}\PY{p}{(}\PY{n}{x\PYZus{}full}\PY{p}{)}
\PY{n}{S\PYZus{}full}  \PY{o}{=} \PY{n}{evaluate\PYZus{}spline}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{,} \PY{n}{x\PYZus{}full}\PY{p}{)}
\PY{n}{f\PYZus{}full}  \PY{o}{=} \PY{n}{f}\PY{p}{(}\PY{n}{x\PYZus{}full}\PY{p}{)}
\PY{n}{L8\PYZus{}small} \PY{o}{=} \PY{n}{L8}\PY{p}{(}\PY{n}{x\PYZus{}small}\PY{p}{)}
\PY{n}{S\PYZus{}small}  \PY{o}{=} \PY{n}{evaluate\PYZus{}spline}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{,} \PY{n}{x\PYZus{}small}\PY{p}{)}
\PY{n}{f\PYZus{}small}  \PY{o}{=} \PY{n}{f}\PY{p}{(}\PY{n}{x\PYZus{}small}\PY{p}{)}
\PY{c+c1}{\PYZsh{} \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{} 绘图 \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 整个区间 [0,64]}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}full}\PY{p}{,} \PY{n}{f\PYZus{}full}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{sqrt}\PY{l+s+si}{\PYZob{}x\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}full}\PY{p}{,} \PY{n}{L8\PYZus{}full}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}L\PYZus{}8(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}full}\PY{p}{,} \PY{n}{S\PYZus{}full}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}S(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ko}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ms}\PY{o}{=}\PY{l+m+mi}{6}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{values in [0, 64]}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 放大观察 L8 和 S 在 [0,64] 上的误差}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}full}\PY{p}{,} \PY{n}{L8\PYZus{}full} \PY{o}{\PYZhy{}} \PY{n}{f\PYZus{}full}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}L\PYZus{}8(x)\PYZhy{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{sqrt}\PY{l+s+si}{\PYZob{}x\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}full}\PY{p}{,} \PY{n}{S\PYZus{}full} \PY{o}{\PYZhy{}} \PY{n}{f\PYZus{}full}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}S(x)\PYZhy{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{sqrt}\PY{l+s+si}{\PYZob{}x\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{errors in [0,64]}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 局部区间 [0,1]}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}small}\PY{p}{,} \PY{n}{f\PYZus{}small}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{sqrt}\PY{l+s+si}{\PYZob{}x\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}small}\PY{p}{,} \PY{n}{L8\PYZus{}small}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}L\PYZus{}8(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}small}\PY{p}{,} \PY{n}{S\PYZus{}small}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}S(x)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{f}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{f}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ko}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ms}\PY{o}{=}\PY{l+m+mi}{6}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{values in [0, 1]}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 误差放大 [0,1]}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}small}\PY{p}{,} \PY{n}{L8\PYZus{}small} \PY{o}{\PYZhy{}} \PY{n}{f\PYZus{}small}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}L\PYZus{}8(x)\PYZhy{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{sqrt}\PY{l+s+si}{\PYZob{}x\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}small}\PY{p}{,} \PY{n}{S\PYZus{}small} \PY{o}{\PYZhy{}} \PY{n}{f\PYZus{}small}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}S(x)\PYZhy{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{sqrt}\PY{l+s+si}{\PYZob{}x\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{errors in [0,1]}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_10_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    从 python 的计算结果可以看出：

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  在区间 \([0, 64]\) 上，\(S(x)\) 的误差明显更小。
\item
  在区间 \([0, 1]\) 上，当 \(S'(x) = 2.0\) 时，\(S(x)\) 的误差略小于
  \(L_8(x)\)。
\end{enumerate}

注：

事实上，在 \([0, 1]\) 区间内，边界条件 \(S'(0)\)
的取值会对结果产生较大影响。

如下面的代码展示了当左边界 \(S'(0)\) 取不同值时，对插值结果在 \([0, 1]\)
区间内的影响。

\begin{itemize}
\tightlist
\item
  \textbf{边界敏感性：} 在插值数据中，区间 {[}0,1{]} 紧邻左端，当 S'(x₀)
  发生较大变化时，会显著改变该处的曲率；
\item
  \textbf{全局耦合效应：}
  由于样条构造要求在所有节点处保持连续性和二阶连续性，边界条件对整个 m
  系统具有较强的耦合效应；
\item
  \textbf{数据分布不均：} 在本例中，数据点分布在 {[}0,64{]}
  上，但我们仅观察 {[}0,1{]}
  内的局部行为，此处受左端条件支配较强，故不同 S'(x₀)
  值可能造成较大的局部形状差异。
\end{itemize}

即使仅稍微改变 S'(x₀) 的值，也会引起在 {[}0,1{]}
区间内插值结果（及其导数）的显著不同，这正是边界条件对三次样条插值结果影响较大的典型例子。

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{110}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 给定数据}
\PY{n}{x\PYZus{}nodes} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{,} \PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{,} \PY{l+m+mi}{36}\PY{p}{,} \PY{l+m+mi}{49}\PY{p}{,} \PY{l+m+mi}{64}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
\PY{n}{y\PYZus{}nodes} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 真值函数：sqrt(x)}
\PY{n}{f} \PY{o}{=} \PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{x}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 用于样条构造的通用函数}
\PY{k}{def} \PY{n+nf}{compute\PYZus{}m\PYZus{}clamped}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{S0\PYZus{}prime}\PY{p}{,} \PY{n}{S\PYZus{}last\PYZus{}prime}\PY{p}{)}\PY{p}{:}
    \PY{n}{h} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{)}
    \PY{n}{d} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{n}{y\PYZus{}nodes}\PY{p}{)} \PY{o}{/} \PY{n}{h}
    \PY{n}{n} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{)}
    \PY{n}{A} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{n}\PY{p}{)}\PY{p}{)}
    \PY{n}{b\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{n}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 内节点 j=1,..., n\PYZhy{}2}
    \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{n}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{n}{A}\PY{p}{[}\PY{n}{j}\PY{p}{,} \PY{n}{j}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{n}{j}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{A}\PY{p}{[}\PY{n}{j}\PY{p}{,} \PY{n}{j}\PY{p}{]}   \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{*} \PY{p}{(}\PY{n}{h}\PY{p}{[}\PY{n}{j}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{n}{h}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}
        \PY{n}{A}\PY{p}{[}\PY{n}{j}\PY{p}{,} \PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{n}{j}\PY{p}{]}
        \PY{n}{b\PYZus{}vec}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{6} \PY{o}{*} \PY{p}{(}\PY{n}{d}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{p}{[}\PY{n}{j}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 边界条件：夹紧条件}
    \PY{c+c1}{\PYZsh{} 左端点： S\PYZsq{}(x₀)=S0\PYZus{}prime}
    \PY{n}{A}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{n}{A}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{n}{b\PYZus{}vec}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{6} \PY{o}{*} \PY{p}{(}\PY{n}{d}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{S0\PYZus{}prime}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 右端点： S\PYZsq{}(xₙ₋₁)=S\PYZus{}last\PYZus{}prime}
    \PY{n}{A}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{=} \PY{n}{h}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{A}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{h}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{b\PYZus{}vec}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{6} \PY{o}{*} \PY{p}{(}\PY{n}{S\PYZus{}last\PYZus{}prime} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
    
    \PY{n}{m} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{solve}\PY{p}{(}\PY{n}{A}\PY{p}{,} \PY{n}{b\PYZus{}vec}\PY{p}{)}
    \PY{k}{return} \PY{n}{m}
\PY{c+c1}{\PYZsh{} 样条评价函数（标准公式）}
\PY{k}{def} \PY{n+nf}{eval\PYZus{}spline}\PY{p}{(}\PY{n}{x\PYZus{}val}\PY{p}{,} \PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{x\PYZus{}val} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}
        \PY{n}{j} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{k}{elif} \PY{n}{x\PYZus{}val} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{:}
        \PY{n}{j} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{2}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{j} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{searchsorted}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{x\PYZus{}val}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}
    \PY{n}{xj} \PY{o}{=} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{p}{]}
    \PY{n}{xj1} \PY{o}{=} \PY{n}{x\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{hj} \PY{o}{=} \PY{n}{xj1} \PY{o}{\PYZhy{}} \PY{n}{xj}
    \PY{n}{A\PYZus{}coef} \PY{o}{=} \PY{p}{(}\PY{n}{xj1} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}val}\PY{p}{)} \PY{o}{/} \PY{n}{hj}
    \PY{n}{B\PYZus{}coef} \PY{o}{=} \PY{p}{(}\PY{n}{x\PYZus{}val} \PY{o}{\PYZhy{}} \PY{n}{xj}\PY{p}{)} \PY{o}{/} \PY{n}{hj}
    \PY{n}{Sx} \PY{o}{=} \PY{n}{A\PYZus{}coef} \PY{o}{*} \PY{n}{y\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{+} \PY{n}{B\PYZus{}coef} \PY{o}{*} \PY{n}{y\PYZus{}nodes}\PY{p}{[}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{hj}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{6} \PY{o}{*} \PY{p}{(}\PY{p}{(}\PY{n}{A\PYZus{}coef}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3} \PY{o}{\PYZhy{}} \PY{n}{A\PYZus{}coef}\PY{p}{)} \PY{o}{*} \PY{n}{m}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{B\PYZus{}coef}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3} \PY{o}{\PYZhy{}} \PY{n}{B\PYZus{}coef}\PY{p}{)} \PY{o}{*} \PY{n}{m}\PY{p}{[}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
    \PY{k}{return} \PY{n}{Sx}
\PY{k}{def} \PY{n+nf}{evaluate\PYZus{}spline\PYZus{}on\PYZus{}grid}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{,} \PY{n}{x\PYZus{}grid}\PY{p}{)}\PY{p}{:}
    \PY{n}{S\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{eval\PYZus{}spline}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{x\PYZus{}grid}\PY{p}{]}\PY{p}{)}
    \PY{k}{return} \PY{n}{S\PYZus{}vals}
\PY{c+c1}{\PYZsh{} 探究不同 S\PYZsq{}(x₀) 的取值}
\PY{c+c1}{\PYZsh{} 固定右端 S\PYZsq{}(xₙ₋₁) 取 1/16}
\PY{n}{S0\PYZus{}prime\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.0}\PY{p}{,} \PY{l+m+mf}{1.5}\PY{p}{,} \PY{l+m+mf}{2.0}\PY{p}{,} \PY{l+m+mf}{2.5}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}
\PY{n}{S\PYZus{}last\PYZus{}prime} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{16}
\PY{c+c1}{\PYZsh{} 构造评价网格，仅在区间 [0, 1] 上显示结果}
\PY{n}{x\PYZus{}small} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{400}\PY{p}{)}
\PY{n}{f\PYZus{}small} \PY{o}{=} \PY{n}{f}\PY{p}{(}\PY{n}{x\PYZus{}small}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\PY{n}{colors} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{S0\PYZus{}prime} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{S0\PYZus{}prime\PYZus{}list}\PY{p}{)}\PY{p}{:}
    \PY{n}{m} \PY{o}{=} \PY{n}{compute\PYZus{}m\PYZus{}clamped}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{S0\PYZus{}prime}\PY{p}{,} \PY{n}{S\PYZus{}last\PYZus{}prime}\PY{p}{)}
    \PY{n}{S\PYZus{}small} \PY{o}{=} \PY{n}{evaluate\PYZus{}spline\PYZus{}on\PYZus{}grid}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{,} \PY{n}{x\PYZus{}small}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 绘制 S(x) 在 [0,1]}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} plt.plot(x\PYZus{}nodes, y\PYZus{}nodes, \PYZsq{}ko\PYZsq{})}
    \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}small}\PY{p}{,} \PY{n}{f\PYZus{}small}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{sqrt}\PY{l+s+si}{\PYZob{}x\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}small}\PY{p}{,} \PY{n}{S\PYZus{}small}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{colors}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{S(x), S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x₀)=}\PY{l+s+si}{\PYZob{}}\PY{n}{S0\PYZus{}prime}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{S(x)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 计算并绘制 S\PYZsq{}(x) 数值（差分近似）}
    \PY{n}{dx} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}5}
    \PY{n}{S1\PYZus{}small} \PY{o}{=} \PY{p}{(}\PY{n}{evaluate\PYZus{}spline\PYZus{}on\PYZus{}grid}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{,} \PY{n}{x\PYZus{}small}\PY{o}{+}\PY{n}{dx}\PY{p}{)} \PY{o}{\PYZhy{}} 
                \PY{n}{evaluate\PYZus{}spline\PYZus{}on\PYZus{}grid}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{,} \PY{n}{x\PYZus{}small}\PY{o}{\PYZhy{}}\PY{n}{dx}\PY{p}{)}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{dx}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}small}\PY{p}{,} \PY{n}{S1\PYZus{}small}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{colors}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x), S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x₀)=}\PY{l+s+si}{\PYZob{}}\PY{n}{S0\PYZus{}prime}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 数值差分近似计算 S\PYZsq{}\PYZsq{}(x)}
    \PY{n}{S2\PYZus{}small} \PY{o}{=} \PY{p}{(}\PY{n}{evaluate\PYZus{}spline\PYZus{}on\PYZus{}grid}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{,} \PY{n}{x\PYZus{}small}\PY{o}{+}\PY{n}{dx}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{evaluate\PYZus{}spline\PYZus{}on\PYZus{}grid}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{,} \PY{n}{x\PYZus{}small}\PY{p}{)} \PY{o}{+} 
                \PY{n}{evaluate\PYZus{}spline\PYZus{}on\PYZus{}grid}\PY{p}{(}\PY{n}{x\PYZus{}nodes}\PY{p}{,} \PY{n}{y\PYZus{}nodes}\PY{p}{,} \PY{n}{m}\PY{p}{,} \PY{n}{x\PYZus{}small}\PY{o}{\PYZhy{}}\PY{n}{dx}\PY{p}{)}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{dx}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}small}\PY{p}{,} \PY{n}{S2\PYZus{}small}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{colors}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x), S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x₀)=}\PY{l+s+si}{\PYZob{}}\PY{n}{S0\PYZus{}prime}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{S}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{(x)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_12_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
\end{document}
